<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; margin: 40px; font-size: 11pt; line-height: 1.6; }
        h1 { text-align: center; font-size: 24pt; margin-bottom: 50px; border-bottom: 3px double #333; padding-bottom: 20px; }
        .content { margin-bottom: 30px; }
        .content h2 { font-size: 14pt; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 15px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 10pt; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; font-weight: bold; }
        td:nth-child(3) { text-align: left; padding-left: 10px; }
        td:nth-child(4), td:nth-child(5), td:nth-child(6) { text-align: right; padding-right: 10px; }
        .total-row td { font-weight: bold; background-color: #f9f9f9; }
        .centered-text { text-align: center; margin: 20px 0; font-size: 12pt; }
        .end-mark { text-align: right; margin-top: 40px; font-size: 12pt; }
        .remarks { white-space: pre-wrap; background-color: #fafafa; border: 1px solid #eee; padding: 15px; border-radius: 5px; font-size: 10pt; }
    </style>
</head>
<body>
    <h1>품 의 서</h1>
    <div class="content"><p>{{ purpose|safe }}</p></div>
    <div class="centered-text">- 아 래 -</div>
    <div class="content">
        <h2>1. 상세 내역</h2>
        <p style="text-align: right; font-size: 9pt; color: #555;">(단위: 원, 부가세 포함)</p>
        <table>
            <thead>
                <tr>
                    <th>No</th>
                    <th>거래처</th>
                    <th>품목</th>
                    <th>단가</th>
                    <th>수량</th>
                    <th>합계</th>
                    <th>비고</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td>{{ item.No }}</td>
                    <td>{{ item.거래처 }}</td>
                    <td>{{ item.품목 }}</td>
                    <td>{{ "{:,.0f}".format(item.단가|float) }}</td>
                    <td>{{ item.수량 }}</td>
                    <td>{{ "{:,.0f}".format(item.합계|float) }}</td>
                    <td>{{ item.비고 }}</td>
                </tr>
                {% endfor %}
                <tr class="total-row">
                    <td colspan="5">총 합계</td>
                    <td>{{ total_sum }}</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="content">
        <h2>2. 비고</h2>
        <div class="remarks">{{ remarks|safe }}</div>
    </div>
    <div class="end-mark">끝.</div>
    <br><br><br>
    <div style="text-align: center;">
        <p>{{ generation_date }}</p>
        <p>상기 내용과 같이 품의하오니 재가하여 주시기 바랍니다.</p>
        <br><br>
        <p>신청자: 사업본부 OOO (인)</p>
    </div>
</body>
</html>
