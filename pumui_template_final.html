<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; margin: 40px; font-size: 11pt; line-height: 1.6; }
        h1 { text-align: center; font-size: 24pt; margin-bottom: 50px; border-bottom: 3px double #333; padding-bottom: 20px; }
        .content { margin-bottom: 30px; }
        .content h2 { font-size: 14pt; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 15px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 10pt; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; word-break: keep-all; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .body-text { white-space: pre-wrap; font-size: 11pt; padding: 10px; }
        .centered-text { text-align: center; margin: 20px 0; font-size: 12pt; }
        .end-mark { text-align: right; margin-top: 40px; font-size: 12pt; }
        .remarks { white-space: pre-wrap; background-color: #fafafa; border: 1px solid #eee; padding: 15px; border-radius: 5px; font-size: 10pt; }
    </style>
</head>
<body>
    <h1>품 의 서</h1>
    <div class="content"><p>{{ purpose|safe }}</p></div>
    <div class="centered-text">- 아 래 -</div>
    <div class="content">
        <h2>1. 상세 내역</h2>
        {% if items %}
            <table>
                <thead>
                    <tr>
                        {% for header in table_headers %}
                            <th>{{ header }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in items %}
                    <tr>
                        {% for header in table_headers %}
                            <td>{{ row.get(header, '') }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% elif body %}
            <div class="body-text">{{ body|safe }}</div>
        {% endif %}
    </div>
    <div class="content">
        <h2>2. 비고</h2>
        <div class="remarks">{{ remarks|safe }}</div>
    </div>
    <div class="end-mark">끝.</div>
    <br><br><br>
    <div style="text-align: center;">
        <p>{{ generation_date }}</p>
        <p>상기 내용과 같이 품의하오니 재가하여 주시기 바랍니다.</p>
        <br><br>
        <p>신청자: 사업본부 OOO (인)</p>
    </div>
</body>
</html>
